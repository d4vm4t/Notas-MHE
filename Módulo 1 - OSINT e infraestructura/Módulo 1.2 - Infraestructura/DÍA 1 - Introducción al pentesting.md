# Definición y propósito del pentesting

>Pentesting (Penetration Testing): Es un ataque simulado y autorizado contra un sistema informático, red o aplicación web para evaluar su seguridad.

# Propósito Principal:
- Identificar vulnerabilidades y debilidades de seguridad antes de que lo haga un atacante malicioso.
- Evaluar la capacidad de los controles de seguridad para proteger los activos.
- Probar la capacidad de detección y respuesta de la organización.
- Cumplir con normativas y estándares de seguridad.

# Tipos de pentesting
## Black box
>El pentester no tiene conocimiento previo del sistema objetivo, simulando un atacante externo sin información privilegiada.

## Características:

- Simula un ataque real de un atacante externo.
- Se enfoca en la superficie de ataque expuesta públicamente.
- Requiere más tiempo para el reconocimiento.

## Grey box
> El pentester tiene un conocimiento limitado del sistema, a menudo credenciales de usuario estándar o acceso a documentación parcial.

### Características:
- Combina elementos de caja negra y blanca.
- Simula un atacante con cierto nivel de acceso (ej., un usuario estándar o un socio).
- Es el tipo más común y a menudo el más eficiente en términos de costo/beneficio.

## White box
> El pentester tiene conocimiento completo del sistema, incluyendo código fuente, arquitectura de red, credenciales y documentación.

### Características:
- Simula un ataque de un empleado interno (insider) o un atacante con acceso privilegiado.
- Permite una cobertura exhaustiva y profunda de las vulnerabilidades.
- Focalizado en la identificación de fallos de lógica o código.

# Activos a explotar en pentesting
## Pentesting Web (Aplicaciones Web):
- **Tipos**: aplicaciones web, APIs, servicios web.
- **Herramientas**: `Burp Suite`, `OWASP ZAP`, `Nikto`

## Pentesting de Red (Infraestructura de Red):
**Tipo**: servidores, dispositivos de red (routers, switches, firewalls), sistemas operativos, servicios de red (SSH, FTP, SMB, DNS).
**Herramientas**: `Nmap`, `Nessus`, `Metasploit`.

# Marcos y metodologías
- **PTES (Penetration Testing Execution Standard)**: Un estándar que define siete fases para un pentest. https://www.pentest-standard.org
- **OWASP (Open Web Application Security Project)**: Guías y herramientas para la seguridad de aplicaciones web. https://owasp.org
- **NIST (National Institute of Standards and Technology)**: Publicaciones y guías de seguridad, incluyendo pentesting. https://www.nist.gov

# Metodología del pentesting
La metodología está compuesta por 4 fases:
## Fase 1: Planificación y Alcance

| Elemento                    | Descripción                                                                                                                             |
| --------------------------- | --------------------------------------------------------------------------------------------------------------------------------------- |
| **Objetivo**                | Definir objetivos del pentest, reglas de compromiso y alcance                                                                           |
| **Información a recopilar** | - Objetivos del negocio<br>- Alcance técnico (IPs, dominios, apps, servicios)<br>- Limitaciones y horarios<br>- Canales de comunicación |
| **Herramientas / recursos** | - Documentos legales (NDA, contratos)<br>- Formularios de autorización<br>- Diagramas de red                                            |
| **Resultado esperado**      | Documento de alcance aprobado + reglas de compromiso firmadas (Rules of Engagement)                                                     |

Conclusiones:
> - Determinar si el test será de caja blanca, gris o negra.  
> - Identificar restricciones legales y técnicas.  
> - Establecer puntos de contacto y canales de comunicación.

---

## Fase 2: Reconocimiento (Activo y Pasivo), Explotación y Acceso Inicial

| Elemento                       | Descripción                                                                                                                                          |
| ------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Objetivo**                   | Identificar vectores de ataque y obtener acceso inicial                                                                                              |
| **Información a recopilar**    | - Subdominios<br>- Servicios expuestos (puertos abiertos)<br>- Tecnologías y frameworks<br>- Plugins, usuarios, rutas<br>- Vulnerabilidades públicas |
| **Herramientas — Pasivo**      | - `theHarvester`<br>- `Shodan`<br>- `crt.sh` / `Censys` / `Whois`<br>- `Sublist3r`                                                                   |
| **Herramientas — Activo**      | - `Nmap` / `Masscan`<br>- `WhatWeb`<br>- `Nikto`<br>- `Nuclei`                                                                                       |
| **Herramientas — Explotación** | - `Metasploit`<br>- `Burp Suite`<br>- `SQLMap`<br>- `OWASP ZAP`<br>- Exploits públicos                                                               |
| **Resultado esperado**         | Lista de vulnerabilidades explotables y accesos iniciales documentados                                                                               |
Conclusiones:
> - Separar bien la enumeración pasiva (sin interactuar con el objetivo) de la activa.  
> - Priorizar CVEs conocidas y exploits públicos antes de desarrollar uno propio.  
> - Documentar cada vector probado y su resultado.

---

## Fase 3: Post Explotación

| Elemento                    | Descripción                                                                                                                  |
| --------------------------- | ---------------------------------------------------------------------------------------------------------------------------- |
| **Objetivo**                | Simular acciones de un atacante persistente tras obtener acceso.                                                             |
| **Información a recopilar** | - Cuentas privilegiadas<br>- Rutas internas y accesos<br>- Información sensible<br>- Tokens y credenciales                   |
| **Acciones comunes**        | - Escalada de privilegios<br>- Movimiento lateral<br>- Persistencia<br>- Recolección de información<br>- Limpieza de huellas |
| **Herramientas**            | - `Mimikatz`<br>- `BloodHound`<br>- `WinPEAS` / `LinPEAS`<br>- PowerShell Empire (`Power_View`)<br>- `Cobalt Strike`         |
| **Resultado esperado**      | Evidencia de escalado, rutas internas, cuentas comprometidas y posibles movimientos internos documentados.                   |
Conclusiones:
> - Mantener trazabilidad clara de las acciones para el informe final.  
> - No afectar los sistemas de producción.  
> - Preparar evidencias sólidas (capturas, logs, timestamps).

---

## Fase 4: Reporting

| Elemento                    | Descripción                                                                                                                                                                                     |
| --------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Objetivo**                | Documentar todos los hallazgos, impactos, exploits exitosos y recomendaciones.                                                                                                                  |
| **Contenido del reporte**   | - Resumen ejecutivo (no técnico)<br>- Alcance y metodología<br>- Evidencia técnica (vulnerabilidad, impacto, logs)<br>- Recomendaciones de remediación<br>- Conclusiones y evaluación de riesgo |
| **Herramientas / formatos** | - Markdown + PDF<br>- Word / LibreOffice Writer<br>- LaTeX (creación de documentos profesionales)                                                                                               |
| **Resultado esperado**      | Entrega final del informe al cliente con hallazgos priorizados y pasos claros de remediación.                                                                                                   |
Conclusiones:
> - Clasificar vulnerabilidades por criticidad (CVSS).  
> - Lenguaje claro para dirección y técnico para IT/SecOps.  
> - Incluir evidencia gráfica y técnica para cada hallazgo.

---

# Buenas prácticas
- Comunicación constante con el cliente
- Documentación exhaustiva de cada paso
- Respetar las reglas de compromiso
- Priorizar la seguridad del cliente
- Proporcionar recomendaciones claras y accionables

# Errores comunes
- Falta de alcance claro
- No obtener autorización adecuada
- Realizar ataques fuera de las reglas de compromiso
- No documentar correctamente los hallazgos
- No comunicar riesgos de forma efectiva
